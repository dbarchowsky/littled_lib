!function(t){let e={errorContainer:".alert-error",statusContainer:".alert-info",csrfSelector:"#csrf-token",progress_markup:'<div class="dialog-in-process"></div>',ajax:{script_path:"/vendor/dbarchowsky/littled_cms/ajax/",content_operations_uri:"utils/script-properties.php",routes_uri:"utils/routes.php"},dom:{page_error_container:".alert-error:first"},keys:{id:"id",content_type_id:"tid",operation:"op",csrf:"csrf"}};t.fn.serializeObject=function(e,r){let i={};return this.each(function(){t.each(t(this).serializeArray(),function(t,e){e.name in i?i[e.name]instanceof Array?i[e.name].push(e.value):i[e.name]=[i[e.name],e.value]:i[e.name]=e.value}),void 0!==r&&t.each(r,function(t,e){e in i&&delete i[e]}),i=t.extend({},i,e||{})}),i},t.fn.setTextboxMessage=function(t){this.littled("setTextboxMessage",t)},t.fn.iconButton=function(t){return this.button({icons:{primary:"ui-icon-"+t},text:!1})},t.fn.allData=function(){let e=jQuery.data(this.get(0));return t.cache[e]},t.littled={addProtocolAndDomain:function(e){return location.protocol+"//"+t.littled.getDomain()+e},configureLocalizedSettings:function(r,i={}){return r&&r.preventDefault(),t.extend(!0,{},e,r&&r.data||{},i)},getDomain:function(){return void 0===window.document.domain?window.document.hostname:window.document.domain},getRelativePath:function(){let t="",e=window.location.href;if(e=e.replace(/^.*:\/\/.*?\/(.*\/).*$/,"$1")){let r=e.split("/").length-1;for(let e=0;e<r;e++)t+="../"}return t},htmldecode:function(t){return void 0===t?"":t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},htmlentities:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},getEventOptions:function(e,r){let i=r||{};return e.hasOwnProperty("data")&&void 0!==e.data&&e.data.hasOwnProperty("options")&&t.extend(i,e.data.options),i},getQueryArray:function(t,e){let r=["id","msg"];void 0!==e&&e.length>=0&&(r=r.concat(e));let n=LITTLED.ptq(document.location.search.substring(1).replace(/\+/g," "),r);for(let t in n)""===n[t]&&delete n[t];if(void 0!==t&&"object"==typeof t)for(i in t)n[i]=t[i];return n},retrieveContentOperations:function(r,i,n){let o=t.extend(!0,{},e,n||{}),s=t.littled.getRelativePath()+o.ajax.script_path+o.ajax.content_operations_uri,a={};a[o.keys.content_type_id]=r,a[o.keys.csrf]=t(o.csrfSelector).html(),t.ajax({type:"post",url:s,dataType:"json",data:a,success:i}).fail(function(e){t(o.dom.page_error_container).littled("ajaxError",e)})},retrieveRoute:function(e,r,i,n={}){let o=t.littled.configureLocalizedSettings(null,n),s={};s[o.keys.operation]=e,s[o.keys.content_type_id]=r,s[o.keys.id]=i,fetch(o.ajax.routes_uri,{method:"post",body:JSON.stringify(s)}).then(t=>t.json()).then(t=>{if(t.error)throw Error(t.error);return t.route}).catch(e=>t(o.errorContainer).littled("displayError",e.message))},updateCache:function(r){r.preventDefault();let i=t.extend(!0,{},e,r.data||{});t(i.errorContainer+":visible").fadeOut("fast"),t(i.statusContainer+":visible").fadeOut("fast");let n=t(this).data("tid"),o=t(this).data("id");n?t.littled.retrieveContentOperations(n,function(e){e.error?t(i.errorContainer).littled("displayError",e.error):e.cache_uri?t.post(e.cache_uri,{tid:n,id:o,csrf:t(i.csrfSelector).html()},function(e){e.error?t(i.errorContainer).littled("displayError",e.error):t(i.statusContainer).littled("displayStatus",e.status)},"json").fail(function(e,r,n){t(i.errorContainer).littled("displayError",r+": "+n.message)}):t(i.errorContainer).littled("displayError","Cache handler not set.")},i):t(i.errorContainer).littled("displayError","Content type not specified.")}};let r={displayAjaxResult:function(e){return this.each(function(){if(e.error){let r=t(".error",t(this));r.length>0?r.html(e.error).show():t(this).html(e.error).addClass("error")}else t(this).html(t.littled.htmldecode(e.content)).show()})},displayError:function(e){return e=e.replace(/\n/gm,"<br />").replace(/<br \/>$/,""),e+='<br /><button class="dismiss-btn smtext">dismiss</button>',this.html(e).show("slow"),this.each(function(){let e=t(this);t("button.dismiss-btn",t(this)).click(function(){t(this).unbind("click"),e.hide("fast")})})},ajaxError:function(e){return"200"===e.status?this.little("displayError",t.littled.htmlentities(e.responseText)):this.littled("displayError","["+e.status+" "+e.statusText+"] "+e.responseText)},displayStatus:function(e){return this.each(function(){e&&t(this).show("slow").html(t.littled.htmldecode(e).replace(/\n/g,"<br />\n"))})},dismissError:function(){t(this).html("").hide("fast")},collectFormDataWithCSRF:function(e,r){let i=t.extend({},{csrf:t(e.csrfSelector).html()},r||{});return t.extend(i,t("input, select, textarea",this).serializeObject())},keyNavigation:function(t){return this.on("keydown",function(e){switch(e.keyCode||e.which){case 37:t.backURL&&(e.preventDefault(),window.location=t.backURL);break;case 39:t.nextURL&&(e.preventDefault(),window.location=t.nextURL);break;case 38:t.upURL&&(e.preventDefault(),window.location=t.upURL);break;case 40:t.downURL&&(e.preventDefault(),window.location=t.downURL)}})},setTextboxMessage:function(e){return this.each(function(){""===t(this).val()&&t(this).val(e).addClass("dimtext"),t(this).blur(function(){""===t(this).val()&&t(this).val(e).addClass("dimtext")}).focus(function(){t(this).val()===e&&t(this).val("").removeClass("dimtext")})})},bindImageRollovers:function(){return this.on("mouseenter",function(){t(this).prop("src",t(this).prop("src").replace(/\.([^.]+)$/,"-over.$1"))}).on("mouseleave",function(){t(this).prop("src",t(this).prop("src").replace(/-over\.([^.]+)$/,".$1"))})},displayProcessWheel:function(r){return this.each(function(){let r=t(this).closest("form");t(".error",r).html("").hide("fast"),t(".status",r).html(e.progress_markup).show()})},formatQueryString:function(){let t=document.location.search.toString();return t=(t=(t=(t=t.replace(/^[\?]/,"&")).replace(new RegExp("&(id|msg|"+LITTLED.id_param+")=.*?&"),"&")).replace(new RegExp("&(id|msg|"+LITTLED.id_param+")=.*$"),"")).replace(/^[\?&]/,"")},testAndAddElement:function(e,r,i){return this.each(function(){let n=null;if(r&&!r instanceof Array){if((n=t(this).closest(r)).length<1)return}else r instanceof Array&&(i=r),n=t(this);if(n.first(e).length<1){let t="<div></div>";if(0===e.indexOf("#"))t.addClass(e).substr(1);else{if(0!==e.indexOf("."))return;t.attr("id",e.substr(1))}if(i instanceof Array)for(let e in i)t.addClass(e);n.prepend(t)}})}};t.fn.littled=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.littled"):r.init.apply(this,arguments)}}(jQuery),function(t){let e={event:"click",width:"auto",height:"auto",dialogClass:"",formLoadCB:null,formDismissCB:null,preContentUpdateCB:null,postContentUpdateCB:null,pagesContainer:".pages-container",dialogSelector:"#globalDialog",errorContainer:"#globalDialog .alert-error:first",pageErrorContainer:".alert-error:first",listingsContainer:".listings",navigationContainer:".page-links-container",filtersSelector:".listings-filters form",csrfSelector:"#csrf-token",displayWarnings:!0,keys:{record_id:"id",content_type_id:"tid",parent_id:"pid",operation:"op",page:"p",commit:"commit",cancel:"cancel",csrf:"csrf"},dom:{dialog_container:"#globalDialog",listings_container:".listings",listings_filters:".listings-filters form",dialog_error_container:"#globalDialog .alert-error:first",page_error_container:".alert-error:first",error_container:".alert-error",status_container:".alert-info:first"},callbacks:{update_content:null}},r={init:function(i){let n=t.extend(!0,{},e,i||{});return this.off(n.event,r.open).on(n.event,i,r.open)},cancel:function(i){let n=t.extend(!0,{},e,i||{});return this.off(n.event,r.open)},open:function(i){i.preventDefault();let n=i.data||{},o=t.extend(!0,{},e,n);r.dismissErrorMessages(n);let s={};if(s[o.keys.operation]=o.hasOwnProperty("scriptData")&&o.scriptData.hasOwnProperty(o.keys.operation)?o.scriptData.op:t(this).data("op"),s[o.keys.record_id]=o.hasOwnProperty("scriptData")&&o.scriptData.hasOwnProperty(o.keys.record_id)?o.scriptData.id:t(this).data("id"),s[o.keys.content_type_id]=o.hasOwnProperty("scriptData")&&o.scriptData.hasOwnProperty(o.keys.content_type_id)?o.scriptData.tid:t(this).data("tid"),s.ssid=s[o.keys.content_type_id],s[o.keys.parent_id]=o.hasOwnProperty("scriptData")&&o.scriptData.hasOwnProperty(o.keys.parent_id)?o.scriptData.pid:t(this).data("pid"),s[o.keys.page]=t(o.dom.listings_container+" table:first").data(o.keys.page),s[o.keys.csrf]=t(o.csrfSelector).html(),void 0===s[o.keys.operation])return void t(o.dom.page_error_container).littled("displayError","Operation not specified.");if(void 0===s[o.keys.content_type_id])return void t(o.dom.page_error_container).littled("displayError","Content type not specified.");t(this);t.littled.retrieveContentOperations(s[o.keys.content_type_id],function(e){if(e.error)return void t(o.dom.page_error_container).littled("displayError",e.error);let i=r.getOperationURI(s[o.keys.operation],e);if(!i)return void t(o.dom.page_error_container).littled("displayError","Operation handler not specified.");s[e.id_param]=s[o.keys.record_id],t.extend(s,o.scriptData||{});let a=t(o.dom.listings_filters).formDialog("retrieveFormFilters",n);Object.keys(a).length>0?t.extend(a,s):a=t.littled.getQueryArray(s),delete a.commit,t.ajax({type:"post",url:i,data:a,dataType:"json"}).success(function(e){e.settings=n,t(o.dom.dialog_container).formDialog("display",e)}).fail(function(e){t(o.dom.page_error_container).littled("ajaxError",e)})})},display:function(r){let i=t.extend(!0,{},e,r.settings||{});return r.error?(t(i.dom.page_error_container).littled("displayError",r.error),!1):this.each(function(){t("#global-modal-content").html(t.littled.htmldecode(r.content)),t(this).dialog({title:r.label,minWidth:360,width:i.width,height:i.height,dialogClass:i.dialogClass,closeOnEscape:!0,modal:!0,open:function(e,n){t(".ui-widget-overlay").click(function(e){e.preventDefault(),t(i.dom.dialog_container).formDialog("close")}),t(this).formDialog("bindDialogHandlers",r.settings),i.formLoadCB&&i.formLoadCB.apply(this,Array.prototype.slice.call(arguments,1))},close:function(e,r){t(".ui-widget-overlay").unbind("click")}})})},bindDialogHandlers:function(i){let n=t.extend(!0,{},e,i||{});return this.each(function(){t(".datepicker",t(this)).datepicker(),t(".dlg-commit-btn",t(this)).button().on("click",i,r.commitOperation),t(".dlg-cancel-btn",t(this)).button().on("click",i,function(e){e.preventDefault(),t(n.dom.dialog_container).formDialog("close")})})},collectValue:function(e,r){let i=t(this).data(e);if(!i&&("object"!=typeof r&&(r=t(this).closest("form")),r.length)){let n=t('input[name="'+e+'"]',r);n.length&&(i=n.val())}return i},commitOperation:function(i){i.preventDefault();let n=i.data||{},o=t.extend(!0,{},e,n);r.dismissErrorMessages(n);let s=t(this).closest("form"),a=t(this).formDialog("collectValue",o.keys.content_type_id,s),l=t(this).formDialog("collectValue",o.keys.operation,s);a?l?t.littled.retrieveContentOperations(a,function(e){if(e.error)return void r.displayError(e.error,n);let i=r.getOperationURI(l,e);i?(i=t.littled.addProtocolAndDomain(i),o.preContentUpdateCB&&o.preContentUpdateCB.apply(this,Array.prototype.slice.call(arguments,1)),s.ajaxSubmit({url:i,type:"post",dataType:"json",success:function(t){null!==t?(t.settings=n,r.onOperationSuccess(t)):r.displayError("No data returned.",n)},error:r.ajaxError})):r.displayError("Invalid operation.",n)}):r.displayError("Operation not specified.",n):r.displayError("Content type not specified.",n)},onOperationSuccess:function(i){let n=i.settings||{},o=t.extend(!0,{},e,n);r.dismissErrorMessages(n),i.error?t(o.dom.dialog_error_container).littled("displayError",i.error):(i.settings=n,"function"==typeof o.callbacks.update_content?o.callbacks.update_content.apply(this,Array.prototype.slice.call(arguments)):t(o.dom.listings_container).listings("updateListingsContent",i),o.postContentUpdateCB&&o.postContentUpdateCB.apply(this,arguments),t(o.dom.dialog_container).formDialog("close",n))},close:function(){return this.each(function(){t(this).dialog("close")})},dismissErrorMessages:function(r){let i=t.extend(!0,{},e,r||{});t(i.dom.error_container+":visible").hide("fast"),t(i.dom.page_error_container+":visible").hide("fast"),t(i.dom.dialog_error_container+":visible").hide("fast")},clearPageContent:function(r){let i=t.extend(!0,{},e,r.settings||{});return this.each(function(){r.error?t(i.dom.page_error_container).littled("displayError",r.error):(t(this).html("<div>\x3c!-- --\x3e</div>"),t(i.dom.status_container).littled("displayStatus",r.status))})},retrieveFormFilters:function(r){let i=t.extend(!0,{},e,r||{}),n={};return this.each(function(){n=t(this).serializeObject(),t.extend(n,{id:t(this).data("id"),pid:t(this).data(i.keys.parent_id),tid:t(this).data(i.keys.content_type_id),p:t(i.dom.listings_container+" table:first").data(i.keys.page)})}),n},retrieveContentOperations:function(e,r,i){t.littled.retrieveContentOperations(e,r,i)},clearMessages:function(){return this.each(function(){t(".message",t(this)).html("").hide("fast"),t(".error",t(this)).html("").hide("fast")})},getOperationURI:function(t,e){if(e.hasOwnProperty("routes")){for(let r=0,i=e.routes.length;r<i;r++)if(t===e.routes[r].operation)return e.routes[r].url}else switch(t){case"edit":return e.edit_uri;case"upload":return e.upload_uri?e.upload_uri:e.edit_uri;case"delete":return e.delete_uri;case"view":case"details":return e.details_uri;default:return""}},ajaxError:function(t,e){let i="["+t.status+" "+t.statusText+"] "+t.responseText;r.displayError(i)},displayError:function(r,i){let n=t.extend(!0,{},e,i||{});t(n.dom.dialog_container).is(":visible")?t(n.dom.dialog_error_container).littled("displayError",r):t(n.dom.page_error_container).littled("displayError",r)}};t.fn.formDialog=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.formDialog"):r.init.apply(this,arguments)}}(jQuery),function(t){var e={edit_uri:"",input_key:"",events:{to_edit:"dblclick",to_commit:"change"},dom:{edit_container:".inline-edit",status_container:".alert-info",page_error_container:".alert-error:first",error_container:".alert-error",csrf_container:"#csrf-token"}},r={init:function(i){var n=t.extend({},e,i||{});return this.each(function(){t(this).off(n.events.to_edit,r.edit).on(n.events.to_edit,i,r.edit)})},edit:function(i){i.preventDefault();var n=i.data,o=t.extend(!0,{},e,n||{}),s=t(this),a={id:t(this).attr("data-id"),csrf:t(o.dom.csrf_container).html()};t.ajax({type:"post",url:o.edit_uri,data:a,dataType:"json"}).success(function(e){if(e.error)t(o.dom.error_container,s).littled("displayError",e.error);else switch(s.html(t.littled.htmldecode(e.content)),o.events.to_commit){case"change":t("select[name="+o.input_key+"]").on("change",n,r.commitEdit);break;case"key":break;default:t(o.dom.page_error_container).littled("displayError","Unhandled event.")}}).fail(function(e,r,i){t(o.dom.page_error_container).littled("displayError",r+": "+i.message)})},commitEdit:function(r){r.preventDefault();var i=t.extend(!0,{},e,r.data||{}),n=t(this).closest("form").serializeObject();t.extend(n,{csrf:t(i.dom.csrf_container).html()});var o=t(this);t.ajax({type:"post",url:i.edit_uri,data:n,dataType:"json"}).success(function(t){o.closest(i.dom.edit_container).littled("displayAjaxResult",t)}).fail(function(e,r,n){t(i.dom.page_error_container).littled("displayError",r+": "+n.message)})}};t.fn.inlineEdit=function(e){if("extendMethods"===e)t.extend(!0,r,arguments[1]);else{if(r[e])return r[e].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof e||!e)return r.init.apply(this,arguments);t.error("Method "+e+" does not exist on jQuery.inlineEdit.")}return!1}}(jQuery),function(t){let e="/vendor/dbarchowsky/littled_cms/ajax/",r={parentSelector:".line-items-container",lineSelector:".line-item",statusSelector:".alert-info",errorSelector:".alert-error",emptySetSelector:".empty-set",csrfSelector:"#csrf-token",insertLocation:"before",commitParam:"commit",cancelParam:"cancel",currentOperation:"edit",add:{selector:".add-line-btn",event:"click",button:"plus",callback:null,verbose:!1,uri:t.littled.addProtocolAndDomain(e+"utils/edit_line_item.php")},edit:{selector:".line-item",event:"dblclick",button:"",callback:null,verbose:!1,uri:t.littled.addProtocolAndDomain(e+"utils/edit_line_item.php")},del:{selector:".delete-line-btn",event:"click",button:"trash",callback:null,verbose:!0,uri:t.littled.addProtocolAndDomain(e+"utils/delete_line_item.php")},save:{selector:".save-line-btn",event:"click",button:"circle-check",callback:null,verbose:!1,uri:t.littled.addProtocolAndDomain(e+"utils/edit_line_item.php")},cancel:{selector:".cancel-line-btn",event:"click",button:"circle-close",callback:null,verbose:!1,uri:t.littled.addProtocolAndDomain(e+"utils/edit_line_item.php")},callbacks:{postContentInsert:null}},i={init:function(e){let n=t.extend({},r,e||{});return"function"!=typeof n.add.callback&&(n.add.callback=i.edit),"function"!=typeof n.edit.callback&&(n.edit.callback=i.edit),"function"!=typeof n.del.callback&&(n.del.callback=i.remove),"function"!=typeof n.save.callback&&(n.save.callback=i.save),"function"!=typeof n.cancel.callback&&(n.cancel.callback=i.cancel),this.each(function(){t(this).off(n.add.event,n.add.selector,n.add.callback).off(n.edit.event,n.edit.selector,n.edit.callback).on(n.add.event,n.add.selector,e,n.add.callback).on(n.edit.event,n.edit.selector,e,n.edit.callback),"click"===n.add.event&&t(n.add.selector,t(this)).iconButton(n.add.button),"click"===n.edit.event&&t(n.edit.selector,t(this)).iconButton(n.edit.button),"click"===n.del.event&&t(n.del.selector,t(this)).iconButton(n.del.button),n.hasOwnProperty("postInit")&&t(this).lineitems(n.postInit)})},edit:function(e){e.preventDefault();let i=e.data||{},n=t.extend(!0,{},r,i),o=t(this);o.lineitems("resetMessages",n);let s={id:t(this).data("id"),pid:t(this).data("pid"),class:t(this).data("type"),var:t(this).data("var"),csrf:t(n.csrfSelector).html()};t.ajax({type:"post",url:n.edit.uri,data:s,dataType:"json"}).success(function(t){t.settings=i,o.lineitems("insertEditFormMarkup",t)}).fail(function(t,e,r){o.lineitems("displayError",e+": "+r.message)})},remove:function(e){e.preventDefault();let i=e.data||{},n=t.extend(!0,{},r,i);n.currentOperation="delete";let o=t(this).closest(n.lineSelector);o.lineitems("resetMessages",n);let s=t(this).closest("form").littled("collectFormDataWithCSRF",n);s.hasOwnProperty(n.commitParam)&&delete s[n.commitParam],t.ajax({type:"post",url:n.del.uri,data:s,dataType:"json"}).success(function(t){t.settings=i,t.settings.currentOperation="delete",o.lineitems("insertEditFormMarkup",t)}).fail(function(t,e,r){o.lineitems("displayError",e+": "+r.message)})},save:function(e){e.preventDefault();let i=t.extend({},r,e.data||{}),n=t(this).closest(i.lineSelector);n.lineitems("resetMessages",i);t.post(i.save.uri,n.littled("collectFormDataWithCSRF",i),function(t){t.settings=i,n.lineitems("insertLineItemMarkup",t)},"json").fail(function(t,e,r){n.lineitems("displayError",e+": "+r.message)})},commitDelete:function(e){e.preventDefault();let i=t.extend({},r,e.data||{}),n=t(this).closest(i.lineSelector);n.lineitems("resetMessages",i);let o=n.littled("collectFormDataWithCSRF",i);t.ajax({type:"post",url:i.del.uri,data:o,dataType:"json"}).success(function(e){e.error?n.lineitems("displayError",e.error,i):(n.length>0&&n.slideToggle("fast",function(){t(this).remove()}),e.status&&i.del.verbose&&n.lineitems("displayStatus",e.status,i))}).fail(function(t,e,r){n.lineitems("displayError",e+": "+r.message)})},cancel:function(e){e.preventDefault();let i=t.extend({},r,e.data||{}),n=t(this).closest(".line-item");n.lineitems("resetMessages",i);let o=n.littled("collectFormDataWithCSRF",i,{cancel:"1"});o.hasOwnProperty(i.commitParam)&&delete o[i.commitParam];t.post(i.cancel.uri,o,function(t){t.settings=i,n.lineitems("insertLineItemMarkup",t)},"json").fail(function(t,e,r){n.lineitems("displayError",e+": "+r.message)})},insertLineItemMarkup:function(e){let i=e.settings||r;if(!e.error)return this.each(function(){let r=t(t.littled.htmldecode(e.content));if(r.length>0){t(this).fadeOut("fast",function(){t(this).replaceWith(r),r.fadeIn("slow")});let n=r.closest(i.parentSelector);n.lineitems("bindNewItemHandlers",i),t(i.emptySetSelector,n).remove(),e.status&&i.save.verbose&&n.lineitems("displayStatus",e.status)}else t(this).fadeOut("fast",function(){t(this).remove()})});this.lineitems("displayError",e.error)},insertEditFormMarkup:function(e){let i=t.extend(!0,{},r,e.settings||{});if(!e.error)return this.each(function(){let r=t(t.littled.htmldecode(e.content));if(r.length){if(e.id)t(this).fadeOut("fast",function(){t(this).replaceWith(r),r.fadeIn("slow")});else{let e=t(this).closest(i.parentSelector);e.length>0&&("before"===i.insertLocation?t("header",e).length>0?t("header",e).after(r):e.prepend(r):e.append(r))}switch(i.currentOperation){case"delete":r.lineitems("bindDeleteFormHandlers");break;default:r.lineitems("bindEditFormHandlers"),"function"==typeof i.callbacks.postContentInsert&&i.callbacks.postContentInsert.apply(r)}}});this.lineitems("displayError",e.error)},bindNewItemHandlers:function(e){return this.each(function(){t(this).lineitems("bindActionHandler",e.edit)})},bindEditFormHandlers:function(e){let i=t.extend({},r,e||{});return this.each(function(){t(".datepicker",t(this)).datepicker(),t(this).lineitems("bindActionHandler",i.save),t(this).lineitems("bindActionHandler",i.del),t(this).lineitems("bindActionHandler",i.cancel)})},bindDeleteFormHandlers:function(e){let n=t.extend({},r,e||{});return this.each(function(){t(n.del.selector,t(this)).iconButton(n.del.button).off(n.del.event,i.commitDelete).on(n.del.event,i.commitDelete),t(this).lineitems("bindActionHandler",n.cancel)})},bindActionHandler:function(e){return this.each(function(){"click"===e.event&&t(e.selector,t(this)).iconButton(e.button),t(e.selector,t(this)).off(e.event,e.callback).on(e.event,e.callback)})},displayError:function(e,i){let n=t.extend({},r,i||{});return this.each(function(){let r=null;r=t(this).is("button")?t(this).closest(n.parentSelector):t(this);let i=t(n.errorSelector,r);i.length<1&&(t(this).prepend('<div class="alert '+n.errorSelector.replace(/^\./,"")+'"></div>'),i=t(n.errorSelector,t(this))),i.is(":visible")?i.slideToggle("fast",function(){t(this).html(e).slideToggle("slow")}):i.html(e).slideToggle("slow")})},displayStatus:function(e,i){let n=t.extend({},r,i||{});return this.each(function(){let r=t(n.statusSelector,t(this));r.length>0&&(r.is(":visible")?r.slideToggle("fast",function(){t(this).html(e).slideToggle("slow")}):r.html(e).slideToggle("slow"))})},resetMessages:function(e){return this.each(function(){let r=t(e.statusSelector,t(this)).is(":visible"),i=t(e.errorSelector,t(this)).is(":visible");r.length>0&&r.slideToggle("fast"),i.length>0&&i.slideToggle("fast")})}};t.fn.lineitems=function(e){if("extendMethods"===e)t.extend(!0,i,arguments[1]);else{if(i[e])return i[e].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof e||!e)return i.init.apply(this,arguments);t.error("Method "+e+" does not exist on jQuery.lineitems.")}return!1}}(jQuery),function(t){let e={displayWarnings:!0,inlineOps:{root:"/vendor/dbarchowsky/littled_cms/ajax/js/",nameURL:"edit_name.php",dateURL:"edit_date.php",accessURL:"edit_access.php",slotURL:"edit_slot.php",pageURL:"edit_page.php",statusURL:"edit_status.php"},uris:{edit_name:"",record_details:"details.php"},listingsContainer:"[deprecated]",pagesContainer:"[deprecated]",errorContainer:"[deprecated]",statusContainer:"[deprecated]",filtersSelector:"[deprecated]",sortableSelector:"[deprecated]",keys:{record_id:"id",parent_id:"pid",content_type_id:"tid",page:"p",operation:"op",csrf:"csrf",uri:"uri"},operations:{listings:"listings",details:"details"},dom:{listings_container:".listings",pages_container:".pages-container",page_error_container:".alert-error:first",error_container:".alert-error",status_container:".alert-info:first",filters_form:".listings-filters:first form",sortable_selector:"tr.rec-row",csrfSelector:"#csrf-token"}},r={bindEditHandlers:function(){return this.each(function(){t("input[type=text],input[type=number]",t(this)).off("keyup",r.testKeyedEntry).off("keypress",r.testKeyedEntry).off("commit",r.saveEdit).on("keyup",r.testKeyedEntry).on("keypress",r.testKeyedEntry).on("commit",r.saveEdit),t("select",t(this)).off("change",r.saveEdit).on("change",r.saveEdit)})},bindListingsHandlers:function(e){let i=t.littled.configureLocalizedSettings(null,e);return this.each(function(){t(this).off("contentUpdate","",r.listingsUpdateCB).on("contentUpdate",i,r.listingsUpdateCB).off("dblclick",".inline-edit-cell",r.editCell).on("dblclick",".inline-edit-cell",e,r.editCell).off("click",".page-btn",r.gotoPage).on("click",".page-btn",e,r.gotoPage).off("click",".details-cell",r.gotoDetailsPage).on("click",".details-cell",e,r.gotoDetailsPage).off("click","button.update-cache-btn",t.littled.updateCache).on("click","button.update-cache-btn",{errorContainer:i.dom.error_container,statusContainer:i.dom.status_container},t.littled.updateCache),t("button.edit-btn",t(this)).formDialog("cancel",e).formDialog(e),t("button.trash-btn",t(this)).formDialog("cancel",e).formDialog(t.extend({},e,{dialogClass:"ui-dialog-delete"})),t(".edit-btn",t(this)).iconButton("edit"),t(".details-btn",t(this)).iconButton("details"),t(".preview-btn",t(this)).iconButton("link"),t(".print-btn",t(this)).iconButton("print"),t(".update-cache-btn",t(this)).iconButton("cache"),t(".trash-btn",t(this)).iconButton("trash")})},editCell:function(e){let i=t.littled.configureLocalizedSettings(e),n=t(this).parent(),o=t(this).data(i.keys.operation),s={t:t(this).data("t")};s[i.keys.record_id]=t(this).data(i.keys.record_id),s[i.keys.operation]=o,s[i.keys.csrf]=t(i.dom.csrfSelector).html();let a=r.getInlineURL(o,e.data||{});t.post(a,s,function(e){e.error?t(i.dom.error_container).littled("displayError",e.error):(n.html(t.littled.htmldecode(e.content)),n.listings("bindEditHandlers"),"date"===o&&t(".datepicker",n).datepicker({onClose:r.saveEdit}))},"json").fail(function(e){t(i.dom.error_container).littled("ajaxError",e)})},getInlineURL:function(r,i){let n,o=t.littled.configureLocalizedSettings(null,i);switch(r){case"name":n=o.inlineOps.root+o.inlineOps.nameURL;break;case"date":n=o.inlineOps.root+o.inlineOps.dateURL;break;case"access":n=o.inlineOps.root+o.inlineOps.accessURL;break;case"slot":n=o.inlineOps.root+o.inlineOps.slotURL;break;case"page":n=o.inlineOps.root+o.inlineOps.pageURL;break;case"status":n=o.inlineOps.root+o.inlineOps.statusURL;break;default:t(e.dom.error_container).littled("displayError","Invalid operation: "+r)}return n},getListingsURI:function(t){if(t.ajax_listings_uri)return t.ajax_listings_uri;if(t.routes)for(let e=0;e<t.routes.length;$i++)if("listings"===t.routes[e].operation)return t.routes[e].url},gotoDetailsPage:function(e){let r=t.littled.configureLocalizedSettings(e),i=t(this).data(r.keys.content_type_id),n=t(this).data(r.keys.record_id);if(!i)throw Error("A content type was not provided.");if(!n)throw Error("A record id was not provided.");window.location=t.littled.retrieveRoute(r.operations.details,i,n)},gotoPage:function(i){let n=t.littled.configureLocalizedSettings(i,e);t(n.dom.status_container).fadeOut("fast");let o=t(n.dom.listings_container),s=t(n.dom.filters_form).littled("collectFormDataWithCSRF",i.data||{});s[n.keys.page]=t(this).data(n.keys.page),s[n.keys.content_type_id]=t("table:first",o).data(n.keys.content_type_id.toLowerCase()),s[n.keys.parent_id]=t("table:first",o).data(n.keys.parent_id.toLowerCase()),t.littled.retrieveContentOperations(s[n.keys.content_type_id],function(e){let i="";e.error?t(n.dom.page_error_container).littled("displayError",e.error):""!==(i=r.getListingsURI(e))?t.post(i,s,function(e){e.error?t(n.dom.page_error_container).littled("displayError",e.error):(t(n.dom.listings_container).littled("displayAjaxResult",e).triggerHandler("contentUpdate"),r.updateNavigationValue(n.keys.page,s[n.keys.page],options))},"json").fail(function(e){t(n.dom.page_error_container).littled("ajaxError",e)}):t(n.dom.page_error_container).littled("displayError","Listings route not found.")})},saveDate:function(r,i,n){let o=t.littled.configureLocalizedSettings(r),s=t(this).parents("form:first");t.post(t.littled.getRelativePath()+e.date_url,s.serializeObject(),function(e){e.settings=options,t(o.dom.listings_container).listings("updateListingsContent",e)},"json").fail(function(e){t(o.dom.page_error_container).littled("ajaxError",e)})},listingsUpdateCB:function(e){t(this).listings("bindListingsHandlers",e.data||{})},saveEdit:function(i){let n=t.extend({},e,i||{}),o=t(this).data("op"),s=t(this).closest("form"),a=t(this).closest(".inline-edit-cell").parent(),l=r.getInlineURL(o,i);t.ajax({type:"post",url:l,data:s.serializeObject(),dataType:"json",success:function(e){e.error?t(n.dom.error_container).littled("displayError",e.error):(a.html(t.littled.htmldecode(e.content)),t(".inline-edit-cell",a).off("dblclick",r.editCell).on("dblclick",r.editCell))},error:function(e){t(n.dom.error_container).littled("ajaxError",e)}})},testKeyedEntry:function(i){let n=t(this).data("id"),o=t(this).data("t"),s=t(this).data("op"),a=t(this).closest(".inline-edit-cell").parent();switch(window.event?window.event.keyCode:i.which){case 13:i.preventDefault(),t(this).trigger("commit");break;case 27:i.preventDefault();let l=r.getInlineURL(s);t.post(l,{id:n,t:o,op:s,cancel:1},function(r){r.error?t(e.dom.error_container).littled("displayError",r.error):a.html(t.littled.htmldecode(r.content))},"json").fail(function(r){t(e.dom.error_container).littled("ajaxError",r)})}},updateListingsContent:function(e){let r=t.littled.configureLocalizedSettings(null,e.settings);if(e.error)return void t(r.dom.error_container).littled("displayError",e.error);let i=r.dom.listings_container||e.container_id,n=t(i);n.length>0?n.html(t.littled.htmldecode(e.content)).triggerHandler("contentUpdate"):!0===r.displayWarnings&&t(r.dom.error_container).littled("displayError",'Content container not found: "'+i+'"'),t(r.dom.status_container).littled("displayStatus",e.status)},updateNavigationValue:function(e,r,i){t.littled.configureLocalizedSettings(null,i);let n,o=window.location.href,s=new RegExp("([?|&])"+e+"=.*?(&|$)","i");n=o.match(s)?o.replace(s,"$1"+e+"="+r+"$2"):o+(o.indexOf("?")>0?"&":"?")+e+"="+r,history.pushState(null,null,n)},bindKeyPageNavigation:function(t){return this.on("keydown",function(e){switch(e.keyCode||e.which){case 37:t.hasOwnProperty("leftKeyURL")&&t.leftKeyURL&&(window.location=t.leftKeyURL);break;case 39:t.hasOwnProperty("rightKeyURL")&&t.rightKeyURL&&(window.location=t.rightKeyURL);break;case 38:t.hasOwnProperty("upKeyURL")&&t.upKeyURL&&(window.location=t.upKeyURL);break;case 40:t.hasOwnProperty("downKeyURL")&&t.downKeyURL&&(window.location=t.downKeyURL)}})}};t.fn.listings=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.listings."),!1):r.init.apply(this,arguments)}}(jQuery),function(t){var e={progressMarkup:'<div class="dialog-in-process"></div>',parentContainer:".kw-container",contentContainer:".kw-cell",errorContainer:".alert-error",statusContainer:".kw-status-container",csrfSelector:"#csrf-token"},r={bindListingsHandlers:function(e){return this.each(function(){t(this).off("contentUpdate",r.updateListingsHandlers).on("contentUpdate",e,r.updateListingsHandlers).off("click",".edit-kw-btn",r.edit).on("click",".edit-kw-btn",e,r.edit).off("click",".kw-commit-btn",r.save).off("click",".kw-cancel-btn",r.cancel).on("click",".kw-commit-btn",e,r.save).on("click",".kw-cancel-btn",e,r.cancel),t(".edit-kw-btn",t(this)).iconButton("edit")})},updateListingsHandlers:function(e){t(this).keywords("bindListingsHandlers",e.data||{})},bindEditButtons:function(){return this.each(function(){var e=t("textarea",t(this));e.height(e.prop("scrollHeight")),t(".kw-commit-btn",t(this)).iconButton("circle-check"),t(".kw-cancel-btn",t(this)).iconButton("circle-close")})},edit:function(r){r.preventDefault(),r.stopPropagation();var i=t.extend(!0,{},e,r.data||{});t(i.errorContainer+":visible").slideToggle("fast");var n=t(this).closest(i.parentContainer),o=t(this).data("id"),s=t(this).data("tid");s?t.littled.retrieveContentOperations(s,function(e){if(e.error)t(i.errorContainer).littled("displayError",e.error);else if(e.keywords_uri){var r={csrf:t(i.csrfSelector).html(),kwpi:o,kwti:s};t.post(e.keywords_uri,r,function(t){t.settings=i,n.keywords("updateKeywordContent",t,function(){n.keywords("bindEditButtons")})},"json").fail(function(t){n.littled("ajaxError",t)}),n.keywords("displayProcessWheel")}else t(i.errorContainer).littled("displayError","Handler not set.")}):t(i.errorContainer).littled("displayError","Content type not set.")},displayError:function(r,i){var n=t.extend(!0,{},e,i||{});return this.each(function(){t(this).keywords("hideProcessWheel"),t(n.errorContainer,t(this)).littled("displayError",r)})},save:function(r){r.preventDefault();var i=t.extend(!0,{},e,r.data||{});t(i.errorContainer+":visible").slideToggle("fast");var n=t(this).closest(i.parentContainer),o=t(this).parents("form:first"),s=t(this).data("tid");t.littled.retrieveContentOperations(s,function(e){var r=o.serializeObject({csrf:t(i.csrfSelector).html()});t.post(e.keywords_uri,r,function(t){t.settings=i,n.keywords("updateKeywordContent",t,function(){n.trigger("contentUpdate")})},"json").fail(function(t){n.littled("ajaxError",t)})})},cancel:function(r){r.preventDefault();var i=t.extend(!0,{},e,r.data||{}),n=t(this).closest(i.parentContainer),o=t(this).parents("form:first"),s=t(this).data("tid");t(this).formDialog("retrieveContentOperations",s,function(e){var r={cancel:"1",csrf:t(i.csrfSelector).html()},s=o.serializeObject(r,["commit"]);t.post(e.keywords_uri,s,function(t){t.settings=i,n.keywords("updateKeywordContent",t,function(){n.trigger("contentUpdate")})},"json").fail(function(t){n.littled("ajaxError",t)})})},updateKeywordContent:function(r,i){var n=t.extend(!0,{},e,r.settings||{});return this.each(function(){if(r.error)t(n.errorContainer,t(this)).littled("displayError",r.error);else{t(n.errorContainer+":visible",t(this)).hide(),t(n.statusContainer+":visible",t(this)).hide();var e=t(n.contentContainer,t(this));e.length>0?e.html(t.littled.htmldecode(r.content)):t(this).keywords("displayError","Keyword container ("+n.contentContainer+") not found. "),"function"==typeof i&&i()}})},displayProcessWheel:function(r){var i=t.extend(!0,{},e,r||{});return this.each(function(){t(i.errorContainer,t(this)).fadeOut("fast"),t(i.statusContainer,t(this)).fadeIn("slow").html(i.progressMarkup)})},hideProcessWheel:function(r){var i=t.extend({},e,r||{});return this.each(function(){t(i.statusContainer,t(this)).fadeOut("fast")})}};t.fn.keywords=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.listings."):r.init.apply(this,arguments)}}(jQuery),function(t){let e={ajax:{script_path:"/vendor/dbarchowsky/littled_cms/ajax/"},uris:{keyword_autocomplete:"utils/keyword_autocomplete.php",record_details:"details.php"},keys:{record_id:"id",parent_id:"pid",content_type:"tid",page:"p",operation:"op",csrf:"csrf"},dom:{listings_container:".listings",page_error_container:".alert-error:first",error_container:".alert-error",filters_form:".listings-filters:first form",csrf_selelctor:"#csrf-token"},selectCallback:null},r={bindAutocomplete:function(i){let n=t.extend(!0,{},e,i||{});return"function"!=typeof n.selectCallback&&(n.selectCallback=r.selectCallback),this.each(function(){let e=t(this).prop("name"),r={};r[n.keys.content_type]=t(this).data(n.keys.content_type),r[n.keys.csrf]=t(n.dom.csrf_selector).html(),t(this).autocomplete({minLength:3,source:function(i,o){r[e]=i.term,t.ajax({type:"post",url:n.ajax.script_path+n.uris.keyword_autocomplete,data:r,dataType:"json"}).success(function(e){e.error?t(n.dom.page_error_container).littled("displayError",e.error):o(t.map(e,function(t){return{item:t.id,label:t.title,value:t.id,term:i.term}}))}).fail(function(e){t(n.dom.page_error_container).littled("ajaxError",e)})},select:n.selectCallback})})},selectCallback:function(r,i){let n=t.extend(!0,{},e,r.data||{});r.preventDefault(),t(this).val(i.item.term+"*");let o=i.item.value,s=t(n.dom.filters_form).serializeArray(),a=t.map(s,function(t){return t.name+"="+encodeURIComponent(t.value)});window.location=n.uris.record_details+"?"+a.join("&")+"&id="+o}};t.fn.keywordFilter=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.keywordFilter."),!1):r.init.apply(this,arguments)}}(jQuery),function(t){var e={uris:{resort:"/vendor/dbarchowsky/littled_cms/ajax/utils/resort.php"},dom:{listings_container:".listings",sortable_selector:"tr.rec-row",status_container:".alert-info:first",page_error_container:".alert-error:first",error_container:".alert-error",filters_form:".listings-filters:first form",csrf_selector:"#csrf-token"},keys:{record_id:"id",parent_id:"pid",content_type:"tid",page_size:"pl",position_offset:"po",operation:"op",csrf:"csrf"}},r={init:function(r){var i=t.extend(!0,{},e,r||{});return this.each(function(){t(this).sortable({items:i.dom.sortable_selector,start:function(e,r){t(i.dom.status_container+":visible").fadeOut("fast");var n=r.helper.data("rid");if(n){var o=t("#pages-row-"+n);o.length<1||o.is("visible")&&(o.addClass("reopen"),o.hide())}},update:function(e,i){e.data=r,t(this).resort("resort",e,i)}})})},bindResort:function(){return r.init.apply(this,arguments)},resort:function(r,i){var n=r.data||{},o=t.extend(!0,{},e,n);return this.each(function(){t(o.dom.page_error_container).hide();var e=i.item.attr("id");e&&(e="#"+e),t(this).resort("refreshSortableRowStyles",e),t(this).sortable("disable"),t(this).parent().children(".progress-msg").show().position({my:"center",at:"center",of:t(this).parent()});var r=t(this).data(o.keys.content_type),s=t(this).data(o.keys.position_offset);if(void 0===r||void 0===s)return t(o.dom.page_error_container).littled("displayError","Section id or page offset values not set!"),void t(this).resort("rollbackSort",e);var a,l=new Array,c=t(this).sortable("toArray");if(c.length>0)for(var d in c)c[d]&&(a=t("#"+c[d]).data("rid"),parseInt(a)>0&&l.push(a));if(l.length<1)t(this).resort("rollbackSort",e);else{var p=t(this);t.littled.retrieveContentOperations(r,function(i){if(i.error)t(o.dom.page_error_container).littled("displayError",i.error);else if(i.sorting_uri){var a={},c=t(o.dom.filters_form);c.length>0&&(a=c.littled("collectFormDataWithCSRF",o));var d={ssid:r,rid:e};d[o.keys.parent_id]=t(this).data(o.keys.parent_id),d[o.keys.record_id]=JSON.stringify(l),d[o.keys.position_offset]=s,t.extend(a,d),t.post(i.sorting_uri,a,function(t){t.settings=n||{},p.resort("onResortComplete",t)},"json").fail(function(e){t(o.dom.page_error_container).littled("ajaxError",e)})}else t(o.dom.page_error_container).littled("displayError","Handler not defined.")})}})},refreshSortableRowStyles:function(e){return this.each(function(){if(!1!==t(this).is("table")&&(t("tr.rec-row:odd",t(this)).removeClass("list list-alt").addClass("list"),t("tr.rec-row:even",t(this)).removeClass("list list-alt").addClass("list-alt"),t("tr.page-row:odd",t(this)).removeClass("list list-alt").addClass("list"),t("tr.page-row:even",t(this)).removeClass("list list-alt").addClass("list-alt"),e)){var r=t(e);if(r.length<1)return;var i=r.prev();if(i.length<0)return;var n=i.data("rid"),o=t("#pages-row-"+n);if(o.length>0&&o.is(":hidden")&&o.insertAfter(i),n=r.data("rid"),(o=t("#pages-row-"+n)).length<1)return;o.insertAfter(r),o.hasClass("reopen")&&(o.slideToggle(),o.removeClass("reopen"))}})},onResortComplete:function(r){var i=r.settings||{},n=t.extend(!0,{},e,i);return this.each(function(){if(t(this).parent().children(".progress-msg").hide(),r.error)return t(this).resort("rollbackSort",r.id),void t(n.dom.page_error_container).littled("displayError",r.error);t(this).resort("refreshSortableRowStyles").sortable("enable"),r.status&&t(n.dom.status_container).littled("displayStatus",r.status)})},onResortFailure:function(r,i){var n=t.extend({},e,i||{});return t(n.dom.page_error_container).littled("displayError",r.responseText),this.each(function(){t(this).parent().children(".progress-msg").hide(),t(this).sortable("enable")})},rollbackSort:function(e,r){return r&&r.hide(),this.each(function(){t(this).sortable("cancel").sortable("enable").resort("refreshSortableRowStyles",e)})}};t.fn.resort=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.resort."),!1):r.init.apply(this,arguments)}}(jQuery);