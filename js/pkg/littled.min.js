"undefined"==typeof LITTLED&&(LITTLED={script_root:"/vendor/littled_cms/ajax/",edit_url:"",delete_url:"",view_url:"",cache_url:"",id_param:"id",progress_html:'<div class="dialog-in-process"></div>',debug:!1,init:function(t){if(void 0!==t)for(let e in t)this[e]=t[e]},ajaxError:function(t){let e=$("#globalDialog");e.length>0&&e.is(":visible")&&e.littled("ajaxError",t)},displayStatus:function(t){t&&$("#status-container").length&&($("#status-container").html(LITTLED.htmldecode(t).replace(/\n/g,"<br />\n")),$("#status-container:hidden").fadeIn("slow"))},doLookup:function(){let t=document.getElementById("dialog-edit-form");if(!t.url.value)return alert("url not set!"),!1;LITTLED.displayProcessWheel(),$("#dialog-edit-form").ajaxSubmit({url:t.url.value,type:"post",dataType:"json",success:LITTLED.onLoadFormSuccess,error:LITTLED.ajaxError}),returnfalse},updateCache:function(){$.littled.updateCache()},getParentObject:function(t){let e;return void 0===t?e=$("body"):"object"==typeof t?e=t:(e=$(t)).length<1&&(e=$("body")),e},oc:function(t){let e={};for(let r=0;r<t.length;r++)e[t[r]]="";return e},ptq:function(t,e){let r,i,n,o=t.replace(/;/g,"&").split("&");for(t={},r=0;r<o.length;r++)n=o[r].split("=",2),i=unescape(n[0]),void 0!==e&&e.length>=0&&i in LITTLED.oc(e)&&(i=""),""!==i&&(t[i]||n.length>1&&(t[i]=unescape(n[1])));return t},getQueryArray:function(t,e){let r=["id","msg"];void 0!==e&&e.length>=0&&(r=r.concat(e));let n=LITTLED.ptq(document.location.search.substring(1).replace(/\+/g," "),r);for(let t in n)""===n[t]&&delete n[t];if(void 0!==t&&"object"==typeof t)for(i in t)n[i]=t[i];return n},getParameterByName:function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");let e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(window.location.href);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))},isObjectEmpty:function(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},getDomain:function(){return void 0===window.document.domain?window.document.hostname:window.document.domain},bindImageRollovers:function(){$("img.ro").hover(function(){$(this).attr("src",$(this).attr("src").replace(/\.([^.]+)$/,"-over.$1"))},function(){$(this).attr("src",$(this).attr("src").replace(/-over\.([^.]+)$/,".$1"))})},edit_cb:function(t){LITTLED.onEditSuccess(t)},onEditSuccess:function(t){if(LITTLED.clearDialogMsg(),t.error)return LITTLED.displayError(t.error.replace("/\n/mg","<br />\n"),"dialog-error-container");if(t.container_id){let e=$("#"+t.container_id);e.length<1&&(e=$("#listings-container"))}else $e=$("#listings-container");return $e.length&&($e.html(LITTLED.htmldecode(t.content)),LITTLED.setSortables()),LITTLED.displayStatus(t.status),LITTLED.dismissDialog(),!1},setSortables:function(){},onContentUpdate:function(t){return t.error?LITTLED.displayError(LITTLED.htmldecode(t.error)):($("#"+t.container_id).html(LITTLED.htmldecode(t.content)),!1)},displayAjaxResult:function(t){if(t.error){let e=null;if(void 0!==t.container_id&&""!==t.container_id)(e=$("#"+t.container_id)).html('<div class="error">'+t.error.replace(/\n/gm,"<br />")+"</div>");else{if(!$("#error-container").length)return alert(t.error),!1;(e=$("#error-container")).html(t.error.replace(/\n/gm,"<br />"))}return e.show(),!1}return $("#"+t.container_id).html(LITTLED.htmldecode(t.content)),$("#"+t.container_id).show(),!1},onLoadFormSuccess:function(t){return LITTLED.clearDialogMsg(),t.error?LITTLED.displayError(t.error):($("#global-modal-content").html(LITTLED.htmldecode(t.content)),$("#globalDialog").dialog({title:t.label,minWidth:360,width:"auto",height:"auto",modal:!0}),$("#globalDialog .datepicker").datepicker(),$("#globalDialog .dlg-commit-btn").button().on("click",LITTLED.commitOp),$("#globalDialog .dlg-cancel-btn").button().on("click",LITTLED.cancel),!1)},commitOp:function(){let t=$(this).data("tid"),e=$(this).data("op");return t?e?(LITTLED.execSectionOp(t,function(t){if(t.error)return LITTLED.displayError(t.error,"dialog-error-container");let r="";switch(e){case"edit":r=t.edit_uri;break;case"delete":r=t.delete_uri;break;default:return LITTLED.displayError("Unhandled operation."),!1}return""===r?(alert("Handler not set."),!1):(r=$.littled.addProtocolAndDomain(r),$("#dialog-edit-form").ajaxSubmit({url:r,type:"post",dataType:"json",success:LITTLED.edit_cb,error:LITTLED.ajaxError}),!1)}),!1):LITTLED.displayError("Operation not specified."):LITTLED.displayError("Content type not specified.")},cancel:function(t){void 0!==LITTLED.Video&&LITTLED.Video.unhideFLV(t),LITTLED.dismissDialog()},initDialog:function(){void 0!==LITTLED.Video&&LITTLED.Video.hideFLV(),$("#dialog-bg").height($(document).height()),$("#dialog-bg").width($(document).width());let t=$(document).scrollTop();$("#dialog-bg").offset({top:t,left:0}),$("#dialog-bg").show(),$("#dialog-error-container").hide(),$("#dialog-status-container").hide(),$("#dialog-form-container").html(LITTLED.progress_html),$("#dialog-container").show(),LITTLED.center($("#dialog-container"))},dismissDialog:function(){void 0!==LITTLED.Video&&LITTLED.Video.unhideFLV(),$("#globalDialog").dialog("close")},clearDialogMsg:function(){$("#dialog-status-container").hide(),$("#dialog-error-container").hide()},execSectionOp:function(t,e){$.ajax({type:"get",url:LITTLED.script_root+"utils/script-properties.php",dataType:"json",data:{tid:t},success:e,error:LITTLED.ajaxError})},getOperationURI:function(t,e){switch(t){case"edit":return e.edit_uri;case"delete":return e.delete_uri;case"view":return e.details_uri;default:return""}},displayProcessWheel:function(t){void 0===t&&(t="dialog"),$("#"+t+"-error-container").html(""),$("#"+t+"-error-container").hide(),$("#"+t+"-status-container").html(LITTLED.progress_html),$("#"+t+"-status-container").show()},center:function(t){let e=$(document).scrollTop()+$(window).height()/2-t.height()/2,r=$(window).width()/2-t.width()/2;t.offset({top:e,left:r})},formatQueryString:function(){let t=document.location.search.toString();return t=(t=(t=(t=t.replace(/^[\?]/,"&")).replace(new RegExp("&(id|msg|"+LITTLED.id_param+")=.*?&"),"&")).replace(new RegExp("&(id|msg|"+LITTLED.id_param+")=.*$"),"")).replace(/^[\?&]/,"")},htmldecode:function(t){return void 0===t?"":t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},displayError:function(t,e){let r=void 0!==e&&e?$("#"+e):$("#error-container");return r.length&&r.littled("displayError",t),!1},dismissError:function(t){let e=void 0!==t&&t?$("#"+t):$("#error-container");e.length&&e.is(":visible")&&e.slideToggle("slow")},dialogError:function(t,e){let r=$("#"+(void 0!==e&&e?e:"dialog")+"-status-container");if(r.length<1&&(r=$("#status-container")),"dialog-status-container"===r.attr("id")&&$("#dialog-container").is(":hidden")&&(r=$("#status-container")),r.length&&r.hide(),(r=$("#"+(void 0!==e&&e?e:"dialog")+"-error-container")).length<1&&(r=$("#error-container")),"dialog-error-container"===r.attr("id")&&$("#dialog-container").is(":hidden")&&(r=$("#error-container")),r.length){r.html(t.replace(/\n/gm,"<br />")),e||r.html(r.html()+' <input class="smtext" type="button" value="close" onclick="LITTLED.cancel()" />'),r.show(),parseInt(r.parent().css("z-index"))>0&&LITTLED.center(r.parent())}},bindInlineTB:function(){$("input.tbi").each(function(){""===$(this).val()&&$(this).val($(this).data("init"))}),$("input.tbi").on("focus",function(){$(this).val()===$(this).data("init")&&$(this).val("")}).on("blur",function(){""===$(this).val()&&$(this).val($(this).data("init"))})},setInputLabel:function(t,e){t.length<1||(t.focus(function(){$(this).val()===e&&($(this).val(""),$(this).removeClass("dimtext"))}).blur(function(){""===$(this).val()&&($(this).val(e),$(this).addClass("dimtext"))}),t.val()||(t.val(e),t.addClass("dimtext")))},onHTTPFailure:function(t){LITTLED.ajaxError(t)}}),function(t){let e={errorContainer:".alert-error",statusContainer:".alert-info",csrfSelector:"#csrf-token",progress_markup:'<div class="dialog-in-process"></div>',ajax:{script_path:"/vendor/dbarchowsky/littled_cms/ajax/",content_operations_uri:"utils/script-properties.php"},dom:{page_error_container:".alert-error:first"},keys:{content_type_id:"tid",csrf:"csrf"}};t.fn.serializeObject=function(e,r){let i={};return this.each(function(){t.each(t(this).serializeArray(),function(t,e){e.name in i?i[e.name]instanceof Array?i[e.name].push(e.value):i[e.name]=[i[e.name],e.value]:i[e.name]=e.value}),void 0!==r&&t.each(r,function(t,e){e in i&&delete i[e]}),i=t.extend({},i,e||{})}),i},t.fn.setTextboxMessage=function(t){this.littled("setTextboxMessage",t)},t.fn.iconButton=function(t){return this.button({icons:{primary:"ui-icon-"+t},text:!1})},t.fn.allData=function(){let e=jQuery.data(this.get(0));return t.cache[e]},t.littled={getDomain:function(){return void 0===window.document.domain?window.document.hostname:window.document.domain},getRelativePath:function(){let t="",e=window.location.href;if(e=e.replace(/^.*:\/\/.*?\/(.*\/).*$/,"$1")){let r=e.split("/").length-1;for(let e=0;e<r;e++)t+="../"}return t},addProtocolAndDomain:function(e){return location.protocol+"//"+t.littled.getDomain()+e},htmldecode:function(t){return void 0===t?"":t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},htmlentities:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},getQueryArray:function(t,e){let r=["id","msg"];void 0!==e&&e.length>=0&&(r=r.concat(e));let n=LITTLED.ptq(document.location.search.substring(1).replace(/\+/g," "),r);for(let t in n)""===n[t]&&delete n[t];if(void 0!==t&&"object"==typeof t)for(i in t)n[i]=t[i];return n},getEventOptions:function(e,r){let i=r||{};return e.hasOwnProperty("data")&&void 0!==e.data&&e.data.hasOwnProperty("options")&&t.extend(i,e.data.options),i},retrieveContentOperations:function(r,i,n){let o=t.extend(!0,{},e,n||{}),a=t.littled.getRelativePath()+o.ajax.script_path+o.ajax.content_operations_uri,s={};s[o.keys.content_type_id]=r,s[o.keys.csrf]=t(o.csrfSelector).html(),t.ajax({type:"post",url:a,dataType:"json",data:s,success:i}).fail(function(e){t(o.dom.page_error_container).littled("ajaxError",e)})},updateCache:function(r){r.preventDefault();let i=t.extend(!0,{},e,r.data||{});t(i.errorContainer+":visible").fadeOut("fast"),t(i.statusContainer+":visible").fadeOut("fast");let n=t(this).data("tid"),o=t(this).data("id");n?t.littled.retrieveContentOperations(n,function(e){e.error?t(i.errorContainer).littled("displayError",e.error):e.cache_uri?t.post(e.cache_uri,{tid:n,id:o,csrf:t(i.csrfSelector).html()},function(e){e.error?t(i.errorContainer).littled("displayError",e.error):t(i.statusContainer).littled("displayStatus",e.status)},"json").fail(function(e,r,n){t(i.errorContainer).littled("displayError",r+": "+n.message)}):t(i.errorContainer).littled("displayError","Cache handler not set.")},i):t(i.errorContainer).littled("displayError","Content type not specified.")}};let r={displayAjaxResult:function(e){return this.each(function(){if(e.error){let r=t(".error",t(this));r.length>0?r.html(e.error).show():t(this).html(e.error).addClass("error")}else t(this).html(t.littled.htmldecode(e.content)).show()})},displayError:function(e){return e=e.replace(/\n/gm,"<br />").replace(/<br \/>$/,""),e+='<br /><button class="dismiss-btn smtext">dismiss</button>',this.html(e).show("slow"),this.each(function(){let e=t(this);t("button.dismiss-btn",t(this)).click(function(){t(this).unbind("click"),e.hide("fast")})})},ajaxError:function(e){return"200"===e.status?this.little("displayError",t.littled.htmlentities(e.responseText)):this.littled("displayError","["+e.status+" "+e.statusText+"] "+e.responseText)},displayStatus:function(e){return this.each(function(){e&&t(this).show("slow").html(t.littled.htmldecode(e).replace(/\n/g,"<br />\n"))})},dismissError:function(){t(this).html("").hide("fast")},collectFormDataWithCSRF:function(e,r){let i=t.extend({},{csrf:t(e.csrfSelector).html()},r||{});return t.extend(i,t("input, select, textarea",this).serializeObject())},keyNavigation:function(t){return this.on("keydown",function(e){switch(e.keyCode||e.which){case 37:t.backURL&&(e.preventDefault(),window.location=t.backURL);break;case 39:t.nextURL&&(e.preventDefault(),window.location=t.nextURL);break;case 38:t.upURL&&(e.preventDefault(),window.location=t.upURL);break;case 40:t.downURL&&(e.preventDefault(),window.location=t.downURL)}})},setTextboxMessage:function(e){return this.each(function(){""===t(this).val()&&t(this).val(e).addClass("dimtext"),t(this).blur(function(){""===t(this).val()&&t(this).val(e).addClass("dimtext")}).focus(function(){t(this).val()===e&&t(this).val("").removeClass("dimtext")})})},bindImageRollovers:function(){return this.on("mouseenter",function(){t(this).prop("src",t(this).prop("src").replace(/\.([^.]+)$/,"-over.$1"))}).on("mouseleave",function(){t(this).prop("src",t(this).prop("src").replace(/-over\.([^.]+)$/,".$1"))})},displayProcessWheel:function(r){return this.each(function(){let r=t(this).closest("form");t(".error",r).html("").hide("fast"),t(".status",r).html(e.progress_markup).show()})},formatQueryString:function(){let t=document.location.search.toString();return t=(t=(t=(t=t.replace(/^[\?]/,"&")).replace(new RegExp("&(id|msg|"+LITTLED.id_param+")=.*?&"),"&")).replace(new RegExp("&(id|msg|"+LITTLED.id_param+")=.*$"),"")).replace(/^[\?&]/,"")},testAndAddElement:function(e,r,i){return this.each(function(){let n=null;if(r&&!r instanceof Array){if((n=t(this).closest(r)).length<1)return}else r instanceof Array&&(i=r),n=t(this);if(n.first(e).length<1){let t="<div></div>";if(0===e.indexOf("#"))t.addClass(e).substr(1);else{if(0!==e.indexOf("."))return;t.attr("id",e.substr(1))}if(i instanceof Array)for(let e in i)t.addClass(e);n.prepend(t)}})}};t.fn.littled=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.littled"):r.init.apply(this,arguments)}}(jQuery),function(t){let e={event:"click",width:"auto",height:"auto",dialogClass:"",formLoadCB:null,formDismissCB:null,preContentUpdateCB:null,postContentUpdateCB:null,pagesContainer:".pages-container",dialogSelector:"#globalDialog",errorContainer:"#globalDialog .alert-error:first",pageErrorContainer:".alert-error:first",listingsContainer:".listings",navigationContainer:".page-links-container",filtersSelector:".listings-filters form",csrfSelector:"#csrf-token",displayWarnings:!0,keys:{record_id:"id",content_type_id:"tid",parent_id:"pid",operation:"op",page:"p",commit:"commit",cancel:"cancel",csrf:"csrf"},dom:{dialog_container:"#globalDialog",listings_container:".listings",listings_filters:".listings-filters form",dialog_error_container:"#globalDialog .alert-error:first",page_error_container:".alert-error:first",error_container:".alert-error",status_container:".alert-info:first"},callbacks:{update_content:null}},r={init:function(i){let n=t.extend(!0,{},e,i||{});return this.off(n.event,r.open).on(n.event,i,r.open)},cancel:function(i){let n=t.extend(!0,{},e,i||{});return this.off(n.event,r.open)},open:function(i){i.preventDefault();let n=i.data||{},o=t.extend(!0,{},e,n);r.dismissErrorMessages(n);let a={};if(a[o.keys.operation]=o.hasOwnProperty("scriptData")&&o.scriptData.hasOwnProperty(o.keys.operation)?o.scriptData.op:t(this).data("op"),a[o.keys.record_id]=o.hasOwnProperty("scriptData")&&o.scriptData.hasOwnProperty(o.keys.record_id)?o.scriptData.id:t(this).data("id"),a[o.keys.content_type_id]=o.hasOwnProperty("scriptData")&&o.scriptData.hasOwnProperty(o.keys.content_type_id)?o.scriptData.tid:t(this).data("tid"),a.ssid=a[o.keys.content_type_id],a[o.keys.parent_id]=o.hasOwnProperty("scriptData")&&o.scriptData.hasOwnProperty(o.keys.parent_id)?o.scriptData.pid:t(this).data("pid"),a[o.keys.page]=t(o.dom.listings_container+" table:first").data(o.keys.page),a[o.keys.csrf]=t(o.csrfSelector).html(),void 0===a[o.keys.operation])return void t(o.dom.page_error_container).littled("displayError","Operation not specified.");if(void 0===a[o.keys.content_type_id])return void t(o.dom.page_error_container).littled("displayError","Content type not specified.");t(this);t.littled.retrieveContentOperations(a[o.keys.content_type_id],function(e){if(e.error)return void t(o.dom.page_error_container).littled("displayError",e.error);let i=r.getOperationURI(a[o.keys.operation],e);if(!i)return void t(o.dom.page_error_container).littled("displayError","Operation handler not specified.");a[e.id_param]=a[o.keys.record_id],t.extend(a,o.scriptData||{});let s=t(o.dom.listings_filters).formDialog("retrieveFormFilters",n);Object.keys(s).length>0?t.extend(s,a):s=t.littled.getQueryArray(a),delete s.commit,t.ajax({type:"post",url:i,data:s,dataType:"json"}).success(function(e){e.settings=n,t(o.dom.dialog_container).formDialog("display",e)}).fail(function(e){t(o.dom.page_error_container).littled("ajaxError",e)})})},display:function(r){let i=t.extend(!0,{},e,r.settings||{});return r.error?(t(i.dom.page_error_container).littled("displayError",r.error),!1):this.each(function(){t("#global-modal-content").html(t.littled.htmldecode(r.content)),t(this).dialog({title:r.label,minWidth:360,width:i.width,height:i.height,dialogClass:i.dialogClass,closeOnEscape:!0,modal:!0,open:function(e,n){t(".ui-widget-overlay").click(function(e){e.preventDefault(),t(i.dom.dialog_container).formDialog("close")}),t(this).formDialog("bindDialogHandlers",r.settings),i.formLoadCB&&i.formLoadCB.apply(this,Array.prototype.slice.call(arguments,1))},close:function(e,r){t(".ui-widget-overlay").unbind("click")}})})},bindDialogHandlers:function(i){let n=t.extend(!0,{},e,i||{});return this.each(function(){t(".datepicker",t(this)).datepicker(),t(".dlg-commit-btn",t(this)).button().on("click",i,r.commitOperation),t(".dlg-cancel-btn",t(this)).button().on("click",i,function(e){e.preventDefault(),t(n.dom.dialog_container).formDialog("close")})})},collectValue:function(e,r){let i=t(this).data(e);if(!i&&("object"!=typeof r&&(r=t(this).closest("form")),r.length)){let n=t('input[name="'+e+'"]',r);n.length&&(i=n.val())}return i},commitOperation:function(i){i.preventDefault();let n=i.data||{},o=t.extend(!0,{},e,n);r.dismissErrorMessages(n);let a=t(this).closest("form"),s=t(this).formDialog("collectValue",o.keys.content_type_id,a),l=t(this).formDialog("collectValue",o.keys.operation,a);s?l?t.littled.retrieveContentOperations(s,function(e){if(e.error)return void r.displayError(e.error,n);let i=r.getOperationURI(l,e);i?(i=t.littled.addProtocolAndDomain(i),o.preContentUpdateCB&&o.preContentUpdateCB.apply(this,Array.prototype.slice.call(arguments,1)),a.ajaxSubmit({url:i,type:"post",dataType:"json",success:function(t){null!==t?(t.settings=n,r.onOperationSuccess(t)):r.displayError("No data returned.",n)},error:r.ajaxError})):r.displayError("Invalid operation.",n)}):r.displayError("Operation not specified.",n):r.displayError("Content type not specified.",n)},onOperationSuccess:function(i){let n=i.settings||{},o=t.extend(!0,{},e,n);r.dismissErrorMessages(n),i.error?t(o.dom.dialog_error_container).littled("displayError",i.error):(i.settings=n,"function"==typeof o.callbacks.update_content?o.callbacks.update_content.apply(this,Array.prototype.slice.call(arguments)):t(o.dom.listings_container).listings("updateListingsContent",i),o.postContentUpdateCB&&o.postContentUpdateCB.apply(this,arguments),t(o.dom.dialog_container).formDialog("close",n))},close:function(){return this.each(function(){t(this).dialog("close")})},dismissErrorMessages:function(r){let i=t.extend(!0,{},e,r||{});t(i.dom.error_container+":visible").hide("fast"),t(i.dom.page_error_container+":visible").hide("fast"),t(i.dom.dialog_error_container+":visible").hide("fast")},clearPageContent:function(r){let i=t.extend(!0,{},e,r.settings||{});return this.each(function(){r.error?t(i.dom.page_error_container).littled("displayError",r.error):(t(this).html("<div>\x3c!-- --\x3e</div>"),t(i.dom.status_container).littled("displayStatus",r.status))})},retrieveFormFilters:function(r){let i=t.extend(!0,{},e,r||{}),n={};return this.each(function(){n=t(this).serializeObject(),t.extend(n,{id:t(this).data("id"),pid:t(this).data(i.keys.parent_id),tid:t(this).data(i.keys.content_type_id),p:t(i.dom.listings_container+" table:first").data(i.keys.page)})}),n},retrieveContentOperations:function(e,r,i){t.littled.retrieveContentOperations(e,r,i)},clearMessages:function(){return this.each(function(){t(".message",t(this)).html("").hide("fast"),t(".error",t(this)).html("").hide("fast")})},getOperationURI:function(t,e){if(e.hasOwnProperty("routes")){for(let r=0,i=e.routes.length;r<i;r++)if(t===e.routes[r].operation)return e.routes[r].url}else switch(t){case"edit":return e.edit_uri;case"upload":return e.upload_uri?e.upload_uri:e.edit_uri;case"delete":return e.delete_uri;case"view":case"details":return e.details_uri;default:return""}},ajaxError:function(t,e){let i="["+t.status+" "+t.statusText+"] "+t.responseText;r.displayError(i)},displayError:function(r,i){let n=t.extend(!0,{},e,i||{});t(n.dom.dialog_container).is(":visible")?t(n.dom.dialog_error_container).littled("displayError",r):t(n.dom.page_error_container).littled("displayError",r)}};t.fn.formDialog=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.formDialog"):r.init.apply(this,arguments)}}(jQuery),function(t){var e={edit_uri:"",input_key:"",events:{to_edit:"dblclick",to_commit:"change"},dom:{edit_container:".inline-edit",status_container:".alert-info",page_error_container:".alert-error:first",error_container:".alert-error",csrf_container:"#csrf-token"}},r={init:function(i){var n=t.extend({},e,i||{});return this.each(function(){t(this).off(n.events.to_edit,r.edit).on(n.events.to_edit,i,r.edit)})},edit:function(i){i.preventDefault();var n=i.data,o=t.extend(!0,{},e,n||{}),a=t(this),s={id:t(this).attr("data-id"),csrf:t(o.dom.csrf_container).html()};t.ajax({type:"post",url:o.edit_uri,data:s,dataType:"json"}).success(function(e){if(e.error)t(o.dom.error_container,a).littled("displayError",e.error);else switch(a.html(t.littled.htmldecode(e.content)),o.events.to_commit){case"change":t("select[name="+o.input_key+"]").on("change",n,r.commitEdit);break;case"key":break;default:t(o.dom.page_error_container).littled("displayError","Unhandled event.")}}).fail(function(e,r,i){t(o.dom.page_error_container).littled("displayError",r+": "+i.message)})},commitEdit:function(r){r.preventDefault();var i=t.extend(!0,{},e,r.data||{}),n=t(this).closest("form").serializeObject();t.extend(n,{csrf:t(i.dom.csrf_container).html()});var o=t(this);t.ajax({type:"post",url:i.edit_uri,data:n,dataType:"json"}).success(function(t){o.closest(i.dom.edit_container).littled("displayAjaxResult",t)}).fail(function(e,r,n){t(i.dom.page_error_container).littled("displayError",r+": "+n.message)})}};t.fn.inlineEdit=function(e){if("extendMethods"===e)t.extend(!0,r,arguments[1]);else{if(r[e])return r[e].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof e||!e)return r.init.apply(this,arguments);t.error("Method "+e+" does not exist on jQuery.inlineEdit.")}return!1}}(jQuery),function(t){let e="/vendor/dbarchowsky/littled_cms/ajax/",r={parentSelector:".line-items-container",lineSelector:".line-item",statusSelector:".alert-info",errorSelector:".alert-error",emptySetSelector:".empty-set",csrfSelector:"#csrf-token",insertLocation:"before",commitParam:"commit",cancelParam:"cancel",currentOperation:"edit",add:{selector:".add-line-btn",event:"click",button:"plus",callback:null,verbose:!1,uri:t.littled.addProtocolAndDomain(e+"utils/edit_line_item.php")},edit:{selector:".line-item",event:"dblclick",button:"",callback:null,verbose:!1,uri:t.littled.addProtocolAndDomain(e+"utils/edit_line_item.php")},del:{selector:".delete-line-btn",event:"click",button:"trash",callback:null,verbose:!0,uri:t.littled.addProtocolAndDomain(e+"utils/delete_line_item.php")},save:{selector:".save-line-btn",event:"click",button:"circle-check",callback:null,verbose:!1,uri:t.littled.addProtocolAndDomain(e+"utils/edit_line_item.php")},cancel:{selector:".cancel-line-btn",event:"click",button:"circle-close",callback:null,verbose:!1,uri:t.littled.addProtocolAndDomain(e+"utils/edit_line_item.php")},callbacks:{postContentInsert:null}},i={init:function(e){let n=t.extend({},r,e||{});return"function"!=typeof n.add.callback&&(n.add.callback=i.edit),"function"!=typeof n.edit.callback&&(n.edit.callback=i.edit),"function"!=typeof n.del.callback&&(n.del.callback=i.remove),"function"!=typeof n.save.callback&&(n.save.callback=i.save),"function"!=typeof n.cancel.callback&&(n.cancel.callback=i.cancel),this.each(function(){t(this).off(n.add.event,n.add.selector,n.add.callback).off(n.edit.event,n.edit.selector,n.edit.callback).on(n.add.event,n.add.selector,e,n.add.callback).on(n.edit.event,n.edit.selector,e,n.edit.callback),"click"===n.add.event&&t(n.add.selector,t(this)).iconButton(n.add.button),"click"===n.edit.event&&t(n.edit.selector,t(this)).iconButton(n.edit.button),"click"===n.del.event&&t(n.del.selector,t(this)).iconButton(n.del.button),n.hasOwnProperty("postInit")&&t(this).lineitems(n.postInit)})},edit:function(e){e.preventDefault();let i=e.data||{},n=t.extend(!0,{},r,i),o=t(this);o.lineitems("resetMessages",n);let a={id:t(this).data("id"),pid:t(this).data("pid"),class:t(this).data("type"),var:t(this).data("var"),csrf:t(n.csrfSelector).html()};t.ajax({type:"post",url:n.edit.uri,data:a,dataType:"json"}).success(function(t){t.settings=i,o.lineitems("insertEditFormMarkup",t)}).fail(function(t,e,r){o.lineitems("displayError",e+": "+r.message)})},remove:function(e){e.preventDefault();let i=e.data||{},n=t.extend(!0,{},r,i);n.currentOperation="delete";let o=t(this).closest(n.lineSelector);o.lineitems("resetMessages",n);let a=t(this).closest("form").littled("collectFormDataWithCSRF",n);a.hasOwnProperty(n.commitParam)&&delete a[n.commitParam],t.ajax({type:"post",url:n.del.uri,data:a,dataType:"json"}).success(function(t){t.settings=i,t.settings.currentOperation="delete",o.lineitems("insertEditFormMarkup",t)}).fail(function(t,e,r){o.lineitems("displayError",e+": "+r.message)})},save:function(e){e.preventDefault();let i=t.extend({},r,e.data||{}),n=t(this).closest(i.lineSelector);n.lineitems("resetMessages",i);t.post(i.save.uri,n.littled("collectFormDataWithCSRF",i),function(t){t.settings=i,n.lineitems("insertLineItemMarkup",t)},"json").fail(function(t,e,r){n.lineitems("displayError",e+": "+r.message)})},commitDelete:function(e){e.preventDefault();let i=t.extend({},r,e.data||{}),n=t(this).closest(i.lineSelector);n.lineitems("resetMessages",i);let o=n.littled("collectFormDataWithCSRF",i);t.ajax({type:"post",url:i.del.uri,data:o,dataType:"json"}).success(function(e){e.error?n.lineitems("displayError",e.error,i):(n.length>0&&n.slideToggle("fast",function(){t(this).remove()}),e.status&&i.del.verbose&&n.lineitems("displayStatus",e.status,i))}).fail(function(t,e,r){n.lineitems("displayError",e+": "+r.message)})},cancel:function(e){e.preventDefault();let i=t.extend({},r,e.data||{}),n=t(this).closest(".line-item");n.lineitems("resetMessages",i);let o=n.littled("collectFormDataWithCSRF",i,{cancel:"1"});o.hasOwnProperty(i.commitParam)&&delete o[i.commitParam];t.post(i.cancel.uri,o,function(t){t.settings=i,n.lineitems("insertLineItemMarkup",t)},"json").fail(function(t,e,r){n.lineitems("displayError",e+": "+r.message)})},insertLineItemMarkup:function(e){let i=e.settings||r;if(!e.error)return this.each(function(){let r=t(t.littled.htmldecode(e.content));if(r.length>0){t(this).fadeOut("fast",function(){t(this).replaceWith(r),r.fadeIn("slow")});let n=r.closest(i.parentSelector);n.lineitems("bindNewItemHandlers",i),t(i.emptySetSelector,n).remove(),e.status&&i.save.verbose&&n.lineitems("displayStatus",e.status)}else t(this).fadeOut("fast",function(){t(this).remove()})});this.lineitems("displayError",e.error)},insertEditFormMarkup:function(e){let i=t.extend(!0,{},r,e.settings||{});if(!e.error)return this.each(function(){let r=t(t.littled.htmldecode(e.content));if(r.length){if(e.id)t(this).fadeOut("fast",function(){t(this).replaceWith(r),r.fadeIn("slow")});else{let e=t(this).closest(i.parentSelector);e.length>0&&("before"===i.insertLocation?t("header",e).length>0?t("header",e).after(r):e.prepend(r):e.append(r))}switch(i.currentOperation){case"delete":r.lineitems("bindDeleteFormHandlers");break;default:r.lineitems("bindEditFormHandlers"),"function"==typeof i.callbacks.postContentInsert&&i.callbacks.postContentInsert.apply(r)}}});this.lineitems("displayError",e.error)},bindNewItemHandlers:function(e){return this.each(function(){t(this).lineitems("bindActionHandler",e.edit)})},bindEditFormHandlers:function(e){let i=t.extend({},r,e||{});return this.each(function(){t(".datepicker",t(this)).datepicker(),t(this).lineitems("bindActionHandler",i.save),t(this).lineitems("bindActionHandler",i.del),t(this).lineitems("bindActionHandler",i.cancel)})},bindDeleteFormHandlers:function(e){let n=t.extend({},r,e||{});return this.each(function(){t(n.del.selector,t(this)).iconButton(n.del.button).off(n.del.event,i.commitDelete).on(n.del.event,i.commitDelete),t(this).lineitems("bindActionHandler",n.cancel)})},bindActionHandler:function(e){return this.each(function(){"click"===e.event&&t(e.selector,t(this)).iconButton(e.button),t(e.selector,t(this)).off(e.event,e.callback).on(e.event,e.callback)})},displayError:function(e,i){let n=t.extend({},r,i||{});return this.each(function(){let r=null;r=t(this).is("button")?t(this).closest(n.parentSelector):t(this);let i=t(n.errorSelector,r);i.length<1&&(t(this).prepend('<div class="alert '+n.errorSelector.replace(/^\./,"")+'"></div>'),i=t(n.errorSelector,t(this))),i.is(":visible")?i.slideToggle("fast",function(){t(this).html(e).slideToggle("slow")}):i.html(e).slideToggle("slow")})},displayStatus:function(e,i){let n=t.extend({},r,i||{});return this.each(function(){let r=t(n.statusSelector,t(this));r.length>0&&(r.is(":visible")?r.slideToggle("fast",function(){t(this).html(e).slideToggle("slow")}):r.html(e).slideToggle("slow"))})},resetMessages:function(e){return this.each(function(){let r=t(e.statusSelector,t(this)).is(":visible"),i=t(e.errorSelector,t(this)).is(":visible");r.length>0&&r.slideToggle("fast"),i.length>0&&i.slideToggle("fast")})}};t.fn.lineitems=function(e){if("extendMethods"===e)t.extend(!0,i,arguments[1]);else{if(i[e])return i[e].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof e||!e)return i.init.apply(this,arguments);t.error("Method "+e+" does not exist on jQuery.lineitems.")}return!1}}(jQuery),function(t){let e={displayWarnings:!0,inlineOps:{root:"/vendor/dbarchowsky/littled_cms/ajax/js/",nameURL:"edit_name.php",dateURL:"edit_date.php",accessURL:"edit_access.php",slotURL:"edit_slot.php",pageURL:"edit_page.php",statusURL:"edit_status.php"},uris:{edit_name:"",record_details:"details.php"},listingsContainer:"[deprecated]",pagesContainer:"[deprecated]",errorContainer:"[deprecated]",statusContainer:"[deprecated]",filtersSelector:"[deprecated]",sortableSelector:"[deprecated]",keys:{record_id:"id",parent_id:"pid",content_type:"tid",page:"p",operation:"op",csrf:"csrf"},dom:{listings_container:".listings",pages_container:".pages-container",page_error_container:".alert-error:first",error_container:".alert-error",status_container:".alert-info:first",filters_form:".listings-filters:first form",sortable_selector:"tr.rec-row",csrfSelector:"#csrf-token"}},r={bindListingsHandlers:function(i){let n=t.extend(!0,{},e,i||{});return this.each(function(){t(this).off("contentUpdate","",r.listingsUpdateCB).on("contentUpdate",n,r.listingsUpdateCB).off("dblclick",".inline-edit-cell",r.editCell).on("dblclick",".inline-edit-cell",i,r.editCell).off("click",".page-btn",r.gotoPage).on("click",".page-btn",i,r.gotoPage).off("click",".details-cell",r.gotoDetailsPage).on("click",".details-cell",i,r.gotoDetailsPage).off("click","button.update-cache-btn",t.littled.updateCache).on("click","button.update-cache-btn",{errorContainer:n.dom.error_container,statusContainer:n.dom.status_container},t.littled.updateCache),t("button.edit-btn",t(this)).formDialog("cancel",i).formDialog(i),t("button.trash-btn",t(this)).formDialog("cancel",i).formDialog(t.extend({},i,{dialogClass:"ui-dialog-delete"})),t(".edit-btn",t(this)).iconButton("edit"),t(".details-btn",t(this)).iconButton("details"),t(".preview-btn",t(this)).iconButton("link"),t(".print-btn",t(this)).iconButton("print"),t(".update-cache-btn",t(this)).iconButton("cache"),t(".trash-btn",t(this)).iconButton("trash")})},listingsUpdateCB:function(e){t(this).listings("bindListingsHandlers",e.data||{})},editCell:function(i){i.preventDefault();let n=t.extend(!0,{},e,i.data||{}),o=t(this).parent(),a=t(this).data(n.keys.operation),s={t:t(this).data("t")};s[n.keys.record_id]=t(this).data(n.keys.record_id),s[n.keys.operation]=a,s[n.keys.csrf]=t(n.dom.csrfSelector).html();let l=r.getInlineURL(a,i.data||{});t.post(l,s,function(e){e.error?t(n.dom.error_container).littled("displayError",e.error):(o.html(t.littled.htmldecode(e.content)),o.listings("bindEditHandlers"),"date"===a&&t(".datepicker",o).datepicker({onClose:r.saveEdit}))},"json").fail(function(e){t(n.dom.error_container).littled("ajaxError",e)})},bindEditHandlers:function(){return this.each(function(){t("input[type=text],input[type=number]",t(this)).off("keyup",r.testKeyedEntry).off("keypress",r.testKeyedEntry).off("commit",r.saveEdit).on("keyup",r.testKeyedEntry).on("keypress",r.testKeyedEntry).on("commit",r.saveEdit),t("select",t(this)).off("change",r.saveEdit).on("change",r.saveEdit)})},testKeyedEntry:function(i){let n=t(this).data("id"),o=t(this).data("t"),a=t(this).data("op"),s=t(this).closest(".inline-edit-cell").parent();switch(window.event?window.event.keyCode:i.which){case 13:i.preventDefault(),t(this).trigger("commit");break;case 27:i.preventDefault();let l=r.getInlineURL(a);t.post(l,{id:n,t:o,op:a,cancel:1},function(r){r.error?t(e.dom.error_container).littled("displayError",r.error):s.html(t.littled.htmldecode(r.content))},"json").fail(function(r){t(e.dom.error_container).littled("ajaxError",r)})}},saveEdit:function(i){let n=t.extend({},e,i||{}),o=t(this).data("op"),a=t(this).closest("form"),s=t(this).closest(".inline-edit-cell").parent(),l=r.getInlineURL(o,i);t.ajax({type:"post",url:l,data:a.serializeObject(),dataType:"json",success:function(e){e.error?t(n.dom.error_container).littled("displayError",e.error):(s.html(t.littled.htmldecode(e.content)),t(".inline-edit-cell",s).off("dblclick",r.editCell).on("dblclick",r.editCell))},error:function(e){t(n.dom.error_container).littled("ajaxError",e)}})},getInlineURL:function(r,i){let n,o=t.extend({},e,i||{});switch(r){case"name":n=o.inlineOps.root+o.inlineOps.nameURL;break;case"date":n=o.inlineOps.root+o.inlineOps.dateURL;break;case"access":n=o.inlineOps.root+o.inlineOps.accessURL;break;case"slot":n=o.inlineOps.root+o.inlineOps.slotURL;break;case"page":n=o.inlineOps.root+o.inlineOps.pageURL;break;case"status":n=o.inlineOps.root+o.inlineOps.statusURL;break;default:t(e.dom.error_container).littled("displayError","Invalid operation: "+r)}return n},saveDate:function(r,i,n){let o=r.data||{},a=t.extend(!0,{},e,o),s=t(this).parents("form:first");t.post(t.littled.getRelativePath()+e.date_url,s.serializeObject(),function(e){e.settings=o,t(a.dom.listings_container).listings("updateListingsContent",e)},"json").fail(function(e){t(a.dom.page_error_container).littled("ajaxError",e)})},updateListingsContent:function(r){let i=t.extend(!0,{},e,r.settings||{});if(r.error)return void t(i.dom.error_container).littled("displayError",r.error);let n=i.dom.listings_container||r.container_id,o=t(n);o.length>0?o.html(t.littled.htmldecode(r.content)).triggerHandler("contentUpdate"):!0===i.displayWarnings&&t(i.dom.error_container).littled("displayError",'Content container not found: "'+n+'"'),t(i.dom.status_container).littled("displayStatus",r.status)},gotoPage:function(i){i.preventDefault();let n=i.data||{},o=t.extend(!0,{},e,n);t(o.dom.status_container).fadeOut("fast");let a=t(o.dom.listings_container),s=t(o.dom.filters_form).littled("collectFormDataWithCSRF",i.data||{});s[o.keys.page]=t(this).data(o.keys.page),s[o.keys.content_type]=t("table:first",a).data(o.keys.content_type.toLowerCase()),s[o.keys.parent_id]=t("table:first",a).data(o.keys.parent_id.toLowerCase()),t.littled.retrieveContentOperations(s[o.keys.content_type],function(e){e.error?t(o.dom.page_error_container).littled("displayError",e.error):e.ajax_listings_uri?t.post(e.ajax_listings_uri,s,function(e){e.error?t(o.dom.page_error_container).littled("displayError",e.error):(t(o.dom.listings_container).littled("displayAjaxResult",e).triggerHandler("contentUpdate"),r.updateNavigationValue(o.keys.page,s[o.keys.page],n))},"json").fail(function(e){t(o.dom.page_error_container).littled("ajaxError",e)}):t(o.dom.page_error_container).littled("displayError","Handler not defined.")})},gotoDetailsPage:function(r){r.preventDefault();let i=t.extend(!0,{},e,r.data||{}),n=t(this).data(i.keys.record_id);if(!n)return void t(this).closest(i.dom.error_container).littled("displayError","A record id was not provided.");if(""===i.uris.record_details)return void t(this).closest(i.dom.error_container).littled("displayError","An URI was not provided.");let o=i.uris.record_details+"?"+i.keys.record_id+"="+n+"&"+t(i.dom.filters_form).serialize();window.location=o},updateNavigationValue:function(r,i,n){t.extend(!0,{},e,n||{});let o,a=window.location.href,s=new RegExp("([?|&])"+r+"=.*?(&|$)","i");o=a.match(s)?a.replace(s,"$1"+r+"="+i+"$2"):a+(a.indexOf("?")>0?"&":"?")+r+"="+i,history.pushState(null,null,o)},bindKeyPageNavigation:function(t){return this.on("keydown",function(e){switch(e.keyCode||e.which){case 37:t.hasOwnProperty("leftKeyURL")&&t.leftKeyURL&&(window.location=t.leftKeyURL);break;case 39:t.hasOwnProperty("rightKeyURL")&&t.rightKeyURL&&(window.location=t.rightKeyURL);break;case 38:t.hasOwnProperty("upKeyURL")&&t.upKeyURL&&(window.location=t.upKeyURL);break;case 40:t.hasOwnProperty("downKeyURL")&&t.downKeyURL&&(window.location=t.downKeyURL)}})}};t.fn.listings=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.listings."),!1):r.init.apply(this,arguments)}}(jQuery),function(t){var e={progressMarkup:'<div class="dialog-in-process"></div>',parentContainer:".kw-container",contentContainer:".kw-cell",errorContainer:".alert-error",statusContainer:".kw-status-container",csrfSelector:"#csrf-token"},r={bindListingsHandlers:function(e){return this.each(function(){t(this).off("contentUpdate",r.updateListingsHandlers).on("contentUpdate",e,r.updateListingsHandlers).off("click",".edit-kw-btn",r.edit).on("click",".edit-kw-btn",e,r.edit).off("click",".kw-commit-btn",r.save).off("click",".kw-cancel-btn",r.cancel).on("click",".kw-commit-btn",e,r.save).on("click",".kw-cancel-btn",e,r.cancel),t(".edit-kw-btn",t(this)).iconButton("edit")})},updateListingsHandlers:function(e){t(this).keywords("bindListingsHandlers",e.data||{})},bindEditButtons:function(){return this.each(function(){var e=t("textarea",t(this));e.height(e.prop("scrollHeight")),t(".kw-commit-btn",t(this)).iconButton("circle-check"),t(".kw-cancel-btn",t(this)).iconButton("circle-close")})},edit:function(r){r.preventDefault(),r.stopPropagation();var i=t.extend(!0,{},e,r.data||{});t(i.errorContainer+":visible").slideToggle("fast");var n=t(this).closest(i.parentContainer),o=t(this).data("id"),a=t(this).data("tid");a?t.littled.retrieveContentOperations(a,function(e){if(e.error)t(i.errorContainer).littled("displayError",e.error);else if(e.keywords_uri){var r={csrf:t(i.csrfSelector).html(),kwpi:o,kwti:a};t.post(e.keywords_uri,r,function(t){t.settings=i,n.keywords("updateKeywordContent",t,function(){n.keywords("bindEditButtons")})},"json").fail(function(t){n.littled("ajaxError",t)}),n.keywords("displayProcessWheel")}else t(i.errorContainer).littled("displayError","Handler not set.")}):t(i.errorContainer).littled("displayError","Content type not set.")},displayError:function(r,i){var n=t.extend(!0,{},e,i||{});return this.each(function(){t(this).keywords("hideProcessWheel"),t(n.errorContainer,t(this)).littled("displayError",r)})},save:function(r){r.preventDefault();var i=t.extend(!0,{},e,r.data||{});t(i.errorContainer+":visible").slideToggle("fast");var n=t(this).closest(i.parentContainer),o=t(this).parents("form:first"),a=t(this).data("tid");t.littled.retrieveContentOperations(a,function(e){var r=o.serializeObject({csrf:t(i.csrfSelector).html()});t.post(e.keywords_uri,r,function(t){t.settings=i,n.keywords("updateKeywordContent",t,function(){n.trigger("contentUpdate")})},"json").fail(function(t){n.littled("ajaxError",t)})})},cancel:function(r){r.preventDefault();var i=t.extend(!0,{},e,r.data||{}),n=t(this).closest(i.parentContainer),o=t(this).parents("form:first"),a=t(this).data("tid");t(this).formDialog("retrieveContentOperations",a,function(e){var r={cancel:"1",csrf:t(i.csrfSelector).html()},a=o.serializeObject(r,["commit"]);t.post(e.keywords_uri,a,function(t){t.settings=i,n.keywords("updateKeywordContent",t,function(){n.trigger("contentUpdate")})},"json").fail(function(t){n.littled("ajaxError",t)})})},updateKeywordContent:function(r,i){var n=t.extend(!0,{},e,r.settings||{});return this.each(function(){if(r.error)t(n.errorContainer,t(this)).littled("displayError",r.error);else{t(n.errorContainer+":visible",t(this)).hide(),t(n.statusContainer+":visible",t(this)).hide();var e=t(n.contentContainer,t(this));e.length>0?e.html(t.littled.htmldecode(r.content)):t(this).keywords("displayError","Keyword container ("+n.contentContainer+") not found. "),"function"==typeof i&&i()}})},displayProcessWheel:function(r){var i=t.extend(!0,{},e,r||{});return this.each(function(){t(i.errorContainer,t(this)).fadeOut("fast"),t(i.statusContainer,t(this)).fadeIn("slow").html(i.progressMarkup)})},hideProcessWheel:function(r){var i=t.extend({},e,r||{});return this.each(function(){t(i.statusContainer,t(this)).fadeOut("fast")})}};t.fn.keywords=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.listings."):r.init.apply(this,arguments)}}(jQuery),function(t){let e={ajax:{script_path:"/vendor/dbarchowsky/littled_cms/ajax/"},uris:{keyword_autocomplete:"utils/keyword_autocomplete.php",record_details:"details.php"},keys:{record_id:"id",parent_id:"pid",content_type:"tid",page:"p",operation:"op",csrf:"csrf"},dom:{listings_container:".listings",page_error_container:".alert-error:first",error_container:".alert-error",filters_form:".listings-filters:first form",csrf_selelctor:"#csrf-token"},selectCallback:null},r={bindAutocomplete:function(i){let n=t.extend(!0,{},e,i||{});return"function"!=typeof n.selectCallback&&(n.selectCallback=r.selectCallback),this.each(function(){let e=t(this).prop("name"),r={};r[n.keys.content_type]=t(this).data(n.keys.content_type),r[n.keys.csrf]=t(n.dom.csrf_selector).html(),t(this).autocomplete({minLength:3,source:function(i,o){r[e]=i.term,t.ajax({type:"post",url:n.ajax.script_path+n.uris.keyword_autocomplete,data:r,dataType:"json"}).success(function(e){e.error?t(n.dom.page_error_container).littled("displayError",e.error):o(t.map(e,function(t){return{item:t.id,label:t.title,value:t.id,term:i.term}}))}).fail(function(e){t(n.dom.page_error_container).littled("ajaxError",e)})},select:n.selectCallback})})},selectCallback:function(r,i){let n=t.extend(!0,{},e,r.data||{});r.preventDefault(),t(this).val(i.item.term+"*");let o=i.item.value,a=t(n.dom.filters_form).serializeArray(),s=t.map(a,function(t){return t.name+"="+encodeURIComponent(t.value)});window.location=n.uris.record_details+"?"+s.join("&")+"&id="+o}};t.fn.keywordFilter=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.keywordFilter."),!1):r.init.apply(this,arguments)}}(jQuery),function(t){var e={uris:{resort:"/vendor/dbarchowsky/littled_cms/ajax/utils/resort.php"},dom:{listings_container:".listings",sortable_selector:"tr.rec-row",status_container:".alert-info:first",page_error_container:".alert-error:first",error_container:".alert-error",filters_form:".listings-filters:first form",csrf_selector:"#csrf-token"},keys:{record_id:"id",parent_id:"pid",content_type:"tid",page_size:"pl",position_offset:"po",operation:"op",csrf:"csrf"}},r={init:function(r){var i=t.extend(!0,{},e,r||{});return this.each(function(){t(this).sortable({items:i.dom.sortable_selector,start:function(e,r){t(i.dom.status_container+":visible").fadeOut("fast");var n=r.helper.data("rid");if(n){var o=t("#pages-row-"+n);o.length<1||o.is("visible")&&(o.addClass("reopen"),o.hide())}},update:function(e,i){e.data=r,t(this).resort("resort",e,i)}})})},bindResort:function(){return r.init.apply(this,arguments)},resort:function(r,i){var n=r.data||{},o=t.extend(!0,{},e,n);return this.each(function(){t(o.dom.page_error_container).hide();var e=i.item.attr("id");e&&(e="#"+e),t(this).resort("refreshSortableRowStyles",e),t(this).sortable("disable"),t(this).parent().children(".progress-msg").show().position({my:"center",at:"center",of:t(this).parent()});var r=t(this).data(o.keys.content_type),a=t(this).data(o.keys.position_offset);if(void 0===r||void 0===a)return t(o.dom.page_error_container).littled("displayError","Section id or page offset values not set!"),void t(this).resort("rollbackSort",e);var s,l=new Array,c=t(this).sortable("toArray");if(c.length>0)for(var d in c)c[d]&&(s=t("#"+c[d]).data("rid"),parseInt(s)>0&&l.push(s));if(l.length<1)t(this).resort("rollbackSort",e);else{var u=t(this);t.littled.retrieveContentOperations(r,function(i){if(i.error)t(o.dom.page_error_container).littled("displayError",i.error);else if(i.sorting_uri){var s={},c=t(o.dom.filters_form);c.length>0&&(s=c.littled("collectFormDataWithCSRF",o));var d={ssid:r,rid:e};d[o.keys.parent_id]=t(this).data(o.keys.parent_id),d[o.keys.record_id]=JSON.stringify(l),d[o.keys.position_offset]=a,t.extend(s,d),t.post(i.sorting_uri,s,function(t){t.settings=n||{},u.resort("onResortComplete",t)},"json").fail(function(e){t(o.dom.page_error_container).littled("ajaxError",e)})}else t(o.dom.page_error_container).littled("displayError","Handler not defined.")})}})},refreshSortableRowStyles:function(e){return this.each(function(){if(!1!==t(this).is("table")&&(t("tr.rec-row:odd",t(this)).removeClass("list list-alt").addClass("list"),t("tr.rec-row:even",t(this)).removeClass("list list-alt").addClass("list-alt"),t("tr.page-row:odd",t(this)).removeClass("list list-alt").addClass("list"),t("tr.page-row:even",t(this)).removeClass("list list-alt").addClass("list-alt"),e)){var r=t(e);if(r.length<1)return;var i=r.prev();if(i.length<0)return;var n=i.data("rid"),o=t("#pages-row-"+n);if(o.length>0&&o.is(":hidden")&&o.insertAfter(i),n=r.data("rid"),(o=t("#pages-row-"+n)).length<1)return;o.insertAfter(r),o.hasClass("reopen")&&(o.slideToggle(),o.removeClass("reopen"))}})},onResortComplete:function(r){var i=r.settings||{},n=t.extend(!0,{},e,i);return this.each(function(){if(t(this).parent().children(".progress-msg").hide(),r.error)return t(this).resort("rollbackSort",r.id),void t(n.dom.page_error_container).littled("displayError",r.error);t(this).resort("refreshSortableRowStyles").sortable("enable"),r.status&&t(n.dom.status_container).littled("displayStatus",r.status)})},onResortFailure:function(r,i){var n=t.extend({},e,i||{});return t(n.dom.page_error_container).littled("displayError",r.responseText),this.each(function(){t(this).parent().children(".progress-msg").hide(),t(this).sortable("enable")})},rollbackSort:function(e,r){return r&&r.hide(),this.each(function(){t(this).sortable("cancel").sortable("enable").resort("refreshSortableRowStyles",e)})}};t.fn.resort=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.resort."),!1):r.init.apply(this,arguments)}}(jQuery);